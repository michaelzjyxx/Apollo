# Industry Screener 主配置文件

# ========== 数据库配置 ==========
database:
  host: ${DB_HOST:localhost}
  port: ${DB_PORT:3306}
  username: ${DB_USERNAME:root}
  password: ${DB_PASSWORD:}
  database: ${DB_DATABASE:industry_screener}
  charset: ${DB_CHARSET:utf8mb4}
  pool_size: 10
  max_overflow: 20
  echo: false  # 是否打印SQL语句

# ========== iFinD API配置 ==========
ifind_api:
  username: ${IFIND_USERNAME:}
  password: ${IFIND_PASSWORD:}
  mode: ${IFIND_MODE:sdk}  # sdk 或 http
  refresh_token: ${IFIND_REFRESH_TOKEN:}  # HTTP模式必需
  http_base_url: ${IFIND_HTTP_BASE_URL:https://quantapi.51ifind.com/api/v1}
  max_retries: 3
  retry_interval: 5  # 秒
  rate_limit: 1      # 每秒最多请求次数
  timeout: 30        # 超时时间(秒)

# ========== 数据更新调度配置 ==========
scheduler:
  enabled: true
  timezone: 'Asia/Shanghai'

  # 季度财务数据更新
  quarterly_data:
    enabled: true
    cron: '0 9 * * 1'  # 每周一9点检查
    lookback_days: 10   # 向前查找10天内披露的季报
    indicators:
      - 'roe'
      - 'gross_margin'
      - 'revenue_growth'
      - 'profit_growth'
      - 'ocf_ni_ratio'
      - 'capex_intensity'
      - 'inventory_yoy'
      - 'inventory_turnover'

  # 月度景气指标更新
  monthly_data:
    enabled: true
    cron: '0 10 15 * *'  # 每月15日10点更新
    indicators:
      - 'pmi'
      - 'new_order'
      - 'm2'
      - 'social_financing'
      - 'ppi'
      - 'cpi'

  # 周度估值/资金数据更新
  weekly_data:
    enabled: true
    cron: '0 9 * * 1'    # 每周一9点更新
    indicators:
      - 'pe_ttm'
      - 'pb'
      - 'northbound_flow'
      - 'main_fund_flow'

  # 年度竞争格局数据更新
  annual_data:
    enabled: true
    cron: '0 9 * * 1'    # 每周一9点检查年报
    lookback_days: 15
    indicators:
      - 'cr5'
      - 'leader_share'

# ========== 日志配置 ==========
logging:
  level: ${LOG_LEVEL:INFO}
  format: '<green>{time:YYYY-MM-DD HH:mm:ss}</green> | <level>{level: <8}</level> | <cyan>{name}</cyan>:<cyan>{function}</cyan>:<cyan>{line}</cyan> - <level>{message}</level>'
  rotation: '100 MB'
  retention: '30 days'
  compression: 'zip'
  log_dir: 'data/logs'

# ========== 缓存配置(可选) ==========
cache:
  enabled: false
  backend: 'redis'  # redis/memory
  redis:
    host: ${REDIS_HOST:localhost}
    port: ${REDIS_PORT:6379}
    db: ${REDIS_DB:0}
    password: ${REDIS_PASSWORD:}
  ttl:
    raw_data: 3600      # 原始数据缓存1小时
    calculated: 1800    # 计算结果缓存30分钟
    scores: 1800        # 评分缓存30分钟

# ========== 申万一级行业配置 ==========
industries:
  shenwan_l1:
    - {code: '801010.SI', name: '农林牧渔'}
    - {code: '801020.SI', name: '采掘'}
    - {code: '801030.SI', name: '化工'}
    - {code: '801040.SI', name: '钢铁'}
    - {code: '801050.SI', name: '有色金属'}
    - {code: '801080.SI', name: '电子'}
    - {code: '801110.SI', name: '家用电器'}
    - {code: '801120.SI', name: '食品饮料'}
    - {code: '801130.SI', name: '纺织服装'}
    - {code: '801140.SI', name: '轻工制造'}
    - {code: '801150.SI', name: '医药生物'}
    - {code: '801160.SI', name: '公用事业'}
    - {code: '801170.SI', name: '交通运输'}
    - {code: '801180.SI', name: '房地产'}
    - {code: '801200.SI', name: '商业贸易'}
    - {code: '801210.SI', name: '休闲服务'}
    - {code: '801230.SI', name: '综合'}
    - {code: '801710.SI', name: '建筑材料'}
    - {code: '801720.SI', name: '建筑装饰'}
    - {code: '801730.SI', name: '电气设备'}
    - {code: '801740.SI', name: '国防军工'}
    - {code: '801750.SI', name: '计算机'}
    - {code: '801760.SI', name: '传媒'}
    - {code: '801770.SI', name: '通信'}
    - {code: '801780.SI', name: '银行'}
    - {code: '801790.SI', name: '非银金融'}
    - {code: '801880.SI', name: '汽车'}
    - {code: '801890.SI', name: '机械设备'}
    - {code: '801950.SI', name: '煤炭'}
    - {code: '801960.SI', name: '石油石化'}
    - {code: '801970.SI', name: '环保'}

# ========== 应用配置 ==========
app:
  name: 'Industry Screener'
  version: '1.0.0'
  debug: ${APP_DEBUG:false}
  timezone: 'Asia/Shanghai'

# ========== Streamlit配置 ==========
streamlit:
  server:
    port: ${STREAMLIT_SERVER_PORT:8501}
    address: ${STREAMLIT_SERVER_ADDRESS:localhost}
  theme:
    primaryColor: '#FF4B4B'
    backgroundColor: '#FFFFFF'
    secondaryBackgroundColor: '#F0F2F6'

# ========== 回测配置 ==========
backtest:
  start_date: '2018-01-01'
  benchmark: '000300.SH'  # 沪深300
  top_n: 10               # 选择TOP N个行业
  rebalance_frequency: 'monthly'  # monthly/quarterly
  min_score: 70           # 最低评分要求

  # 龙头股配置
  top_stocks:
    n_stocks: 3           # 每个行业选前N只个股
    weight_method: 'equal' # equal/market_cap

# ========== 数据验证规则 ==========
validation:
  completeness_threshold: 0.9  # 缺失值不超过10%

  value_ranges:
    roe: [-100, 100]
    gross_margin: [0, 100]
    pe_ttm: [0, 1000]
    pb: [0, 100]

  timeliness:
    quarterly: 120  # 季度数据不超过120天
    monthly: 60     # 月度数据不超过60天
    weekly: 14      # 周度数据不超过14天
